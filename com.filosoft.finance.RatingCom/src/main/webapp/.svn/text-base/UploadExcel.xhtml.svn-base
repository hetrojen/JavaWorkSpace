

<!-- 
		Replace path to template, title, header and body
		with actual data.
	 -->
<ui:composition 
 xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui"
template="templates/mainTemplate.xhtml">


	<ui:define name="center">

		<h:form id="uploadExcel">
			
			<h:panelGrid columns="1" style="width:750px;">
<p:messages></p:messages>
				<p:panel header="Değerlendirmenin ait olduğu yılı ve dönemi seçiniz">

					<h:panelGrid columns="2">
						<h:outputText value="Dönem:"></h:outputText>
						<h:selectOneMenu id="donemCss" value="#{generalData.donem_combo}">
							<p:ajax event="change" update="uploadExcel"
								action="#{uploadView.dateChanged}"></p:ajax>
							<f:selectItem itemLabel="1.dönem" itemValue="1"></f:selectItem>
							<f:selectItem itemLabel="2.dönem" itemValue="2"></f:selectItem>
							<f:selectItem itemLabel="3.dönem" itemValue="3"></f:selectItem>
							<f:selectItem itemLabel="4.dönem" itemValue="4"></f:selectItem>
						</h:selectOneMenu>
						<h:outputText value="Yıl:"></h:outputText>

						<h:selectOneMenu id="yilCas" value="#{generalData.yil_combo}">
							<p:ajax event="change" update="uploadExcel"
								action="#{uploadView.dateChanged}"></p:ajax>
							<f:selectItems value="#{uploadView.years}"></f:selectItems>
						</h:selectOneMenu>

					</h:panelGrid>
				</p:panel>

				<p:panel id="secimPanel">

					<h:panelGrid rendered="#{uploadViewData.visibleFileUpload}"
						style="spacing:0px;padding: 0px;">
						<p:panel>
							<h:outputText styleClass="lenghtHeader"
								value="Seçilen Firmanın #{generalData.yil} yılı #{generalData.donem}.dönemine ait mali oranlar dosyasını yükleyiniz"></h:outputText>

							<p:fileUpload label="Dosya Sec" auto="true" customUI="true"
								update="uploadExcel"
								fileUploadListener="#{uploadView.handleFileUpload}"
								allowTypes="*.xls;*.xlsx" sizeLimit="250000">

							</p:fileUpload>




						</p:panel>
					</h:panelGrid>
					<h:panelGrid rendered="#{uploadViewData.visibleUploadedFile}">
						<p:panel header="Yüklenen dosya Bilgileri" style="width:600px;">
							<h:panelGrid columns="3" style="spacing:0px;padding: 0px;">
								<h:outputText value="#{uploadView.uploadedFileName}"></h:outputText>

								<p:commandButton value="Kullan"
									action="#{uploadView.useUplodedFile}"
									onstart="validateFileInfo.show();" oncomplete="validateFileInfo.hide();"
									 update="uploadExcel"></p:commandButton>
								<p:commandButton value="Değiştir"
									action="#{uploadView.uploadFile}" update="uploadExcel"></p:commandButton>
							</h:panelGrid>

						</p:panel>
					</h:panelGrid>
					<h:panelGrid columns="1"  id="gelirBInfo"
						rendered="#{uploadViewData.visibleShowExistingKayit}">
						<h:outputLabel styleClass="lenghtHeader" 
							value="Firmanın #{generalData.yil} yılı #{generalData.donem}.dönemine ait, kayıtlı gelir ve bilanço bilgileri var, ne yapmak istersiniz?"></h:outputLabel>
						<p:commandLink  update="gelirBInfo" oncomplete="window.open('/RatingCom/viewFile/FileViewer','Gelir\BilancoBilgileri');"  action="#{uploadView.showGelirBilanco}">
						<h:outputText  styleClass="commandLink" value="Görüntüle" ></h:outputText>
						</p:commandLink>

						<p:commandLink  type="button"
							onclick="conD.show()">
							<h:outputText  styleClass="commandLink"  value="Yeni Oluştur"></h:outputText>
							</p:commandLink>
						<p:commandLink  ajax="false" 
							action="#{uploadView.showBilancoGelir}">
                        <h:outputText  styleClass="commandLink"  value="Değiştir"></h:outputText>
						</p:commandLink>
					</h:panelGrid>



					<h:panelGrid rendered="#{uploadViewData.visibleDataCreateMethod}">
						<h:outputText
							value="Mali oranlar bilgisinin yükleme şeklini seçiniz:" styleClass="lenghtHeader"></h:outputText>
						<p:commandLink styleClass="commandLink" update="uploadExcel"
						
							action="#{uploadView.uploadFile}">
							  <h:outputText  styleClass="commandLink" 	value="Dosya  yükleyerek  oluştur"></h:outputText>
							</p:commandLink>
						<p:commandLink styleClass="commandLink" ajax="false" 
							action="#{uploadView.startGelirBilancoEdit}">
							 <h:outputText  styleClass="commandLink" 	value="Form kullanarak olştur"></h:outputText>
						</p:commandLink>

					</h:panelGrid>

				</p:panel>




			</h:panelGrid>
	








		</h:form>
					<h:form id="dialog">
		
				<p:confirmDialog zindex="100000" closable="false" modal="false" draggable="false"
				message="Firmanın mali oran dosyası ve ona  bağlı kayıtlar seçili  yıl ve dönem için silinecek, Onaylıyor musunuz?"
				widgetVar="conD">
				<p:commandButton type="button" value="Hayır" onclick="conD.hide()"></p:commandButton>
				<p:commandButton value="Evet" oncomplete="conD.hide()"
					update="uploadExcel" action="#{uploadView.deleteRecords}"></p:commandButton>
				
			</p:confirmDialog>


			<p:dialog zindex="100000" fixedCenter="true" modal="true" resizable="false" closable="false"
				 draggable="false" widgetVar="validateFileInfo">

				<h:outputLabel value="Dosya doğrulanıyor..."></h:outputLabel>
				
			</p:dialog>
		
		</h:form>

	</ui:define>
</ui:composition>

